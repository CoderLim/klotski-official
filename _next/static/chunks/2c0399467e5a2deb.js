(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33399,(e,r,t)=>{r.exports=e.r(47151)},34975,(e,r,t)=>{!function(){"use strict";var s=!0,o=5,l=4,a=6,n=7,i=3,c=1;function d(){var e,r=[{x:0,y:1},{x:1,y:0},{x:0,y:-1},{x:-1,y:0}];function t(e,r){return e[r[0]+"-"+r[1]]}function d(s,o,a,n){for(var i=n?s.hashMirror:s.hash,c=s.blocks[o],d=c.shape,u=c.row,h=t(s.types,d),p=n?l-1-c.col:c.col,f=n?-1:1,m=r[n&&a%2==1?(a+2)%4:a],x=m.x,g=m.y,b=0;b<d[0];b++)for(var v=0;v<d[1];v++)i^=e.key[u+b][p+v*f].value[h],i^=e.key[u+b][p+v*f].value[0];for(var b=0;b<d[0];b++)for(var v=0;v<d[1];v++)i^=e.key[u+g+b][p+x+v*f].value[0],i^=e.key[u+g+b][p+x+v*f].value[h];return i}function u(e,r,t,s,o){for(var l=1;l<=t[0];l++)for(var a=1;a<=t[1];a++)e.board[s+l][o+a]=r+1}function h(e,t,o,l){if(function(e,t,s){var o=e.blocks[t];if(o.directions&&-1===o.directions.indexOf(s))return!1;for(var l=o.shape,a=r[s],n=1;n<=l[0];n++)for(var i=1;i<=l[1];i++){var c=e.board[o.row+a.y+n][o.col+a.x+i];if(0!==c&&c!==t+1)return!1}return!0}(t,o,l)){var a=d(t,o,l);if(e.zhash[a])return null;var i=0;if(s&&(i=d(t,o,l,!0),e.zhash[i]))return null;var c=function(e){for(var r=[],t=0;t<n;t++)r[t]=e.board[t].slice(0);for(var s=[],t=0;t<e.blocks.length;t++)s[t]={shape:e.blocks[t].shape.slice(0),directions:e.blocks[t].directions?e.blocks[t].directions.slice(0):null,row:e.blocks[t].row,col:e.blocks[t].col};var o={};for(var l in e.types)e.types.hasOwnProperty(l)&&(o[l]=e.types[l]);return{board:r,blocks:s,types:o,move:{blockIdx:e.move.blockIdx,dirIdx:e.move.dirIdx},step:e.step,hash:e.hash,hashMirror:e.hashMirror,parent:e.parent}}(t),h=c.blocks[o],p=r[l];return!function(e,r,t,s){for(var o=1;o<=r[0];o++)for(var l=1;l<=r[1];l++)e.board[t+o][s+l]=0}(c,h.shape,h.row,h.col),u(c,o,h.shape,h.row+p.y,h.col+p.x),h.row=h.row+p.y,h.col=h.col+p.x,c.blocks[o]=h,c.step=t.step+1,c.parent=t,c.move.blockIdx=o,c.move.dirIdx=l,c.hash=a,s&&(c.hashMirror=i),c}return null}function p(e,r){var t=r.hash,o=0;return!e.zhash[t]&&(!s||(o=r.hashMirror,!e.zhash[o]))&&(e.zhash[t]=!0,s&&(e.zhash[o]=!0),e.states.push(r),!0)}this.solve=function(r){if(r&&(r.hasOwnProperty("useMirror")&&"boolean"==typeof r.useMirror&&(s=r.useMirror),r.hasOwnProperty("boardSize")&&"[object Array]"===Object.prototype.toString.call(r.boardSize)&&2===r.boardSize.length&&(o=r.boardSize[0],a=(l=r.boardSize[1])+2,n=o+2),r.hasOwnProperty("escapePoint")&&"[object Array]"===Object.prototype.toString.call(r.escapePoint)&&2===r.escapePoint.length&&(i=r.escapePoint[0],c=r.escapePoint[1]),r.hasOwnProperty("blocks")&&"[object Array]"===Object.prototype.toString.call(r.blocks))){var d=function(r){var s,i,c,d,h={states:[],zhash:{},result:{time:null,moves:[]}},p={board:[],blocks:[],types:{},move:{blockIdx:0,dirIdx:0},step:0,hash:0,hashMirror:0,parent:null};for(s=0;s<n;s++)for(i=0,p.board[s]=[];i<a;i++)p.board[s][i]=0;for(s=0;s<a;s++)p.board[0][s]=-1,p.board[n-1][s]=-1;for(s=1;s<n-1;s++)p.board[s][0]=-1,p.board[s][a-1]=-1;if(p.parent=null,p.step=0,p.move.blockIdx=0,p.move.dirIdx=0,!r||0===r.length||"object"!=typeof r[0])return null;for(var f=0;f<r.length;f++){var m={shape:r[f].shape,row:r[f].position[0],col:r[f].position[1],directions:r[f].directions||null};if(!function(e,r,t){if(function(e,r,t,s){for(var o=1;o<=r[0];o++)for(var l=1;l<=r[1];l++)if(0!==e.board[t+o][s+l])return!1;return!0}(e,t.shape,t.row,t.col)){var s,o,l;return u(e,r,t.shape,t.row,t.col),(s=e.types)[l=(o=t.shape)[0]+"-"+o[1]]||(s[l]=Object.keys(s).length+1),e.blocks.push(t),!0}return!1}(p,f,m))return null}var x=Object.keys(p.types).length;for(c=0,e={key:[]};c<o;c++)for(d=0,e.key[c]=[];d<l;d++)e.key[c][d]={value:[]},function(e,r){var t;for(t=0;t<e;t++)r.value[t]=function(){var e=0;do e=Math.floor(0x80000000*Math.random());while(!e)return parseInt(e)}()}(x,e.key[c][d]);return p.hash=function(r){var s,a,n=0,i=r.blocks;for(s=1;s<=o;s++)for(a=1;a<=l;a++){var c=r.board[s][a]-1,d=c>=0&&c<i.length?t(r.types,i[c].shape):0;n^=e.key[s-1][a-1].value[d]}return n}(p),p.hashMirror=function(r){var s,a,n=0,i=r.blocks;for(s=1;s<=o;s++)for(a=1;a<=l;a++){var c=r.board[s][a]-1,d=c>=0&&c<i.length?t(r.types,i[c].shape):0;n^=e.key[s-1][l-a].value[d]}return n}(p),h.states.push(p),h}(r.blocks);if(d&&function(e){for(var r=0;r<e.states.length;){var t=e.states[r++];if(!function(e,r){var t=r.hash;if(e.zhash[t]=!0,s){var o=r.hashMirror;e.zhash[o]=!0}}(e,t),function(e,r){var t=r.blocks[0];return t.row===i&&t.col===c}(0,t))return!function(e,r){for(var t=r;t;){if(t.step>0){var s={step:t.step,blockIdx:t.move.blockIdx,dirIdx:t.move.dirIdx};e.result.moves.push(s)}t=t.parent}}(e,t),!0;for(var o=e,l=t,a=0;a<l.blocks.length;a++)for(var n=0;n<4;n++)!function(e,r,t,s){var o=h(e,r,t,s);if(o&&p(e,o)){for(var l=e,a=o,n=t,i=s,c=0;c<4;c++)if((c+2)%4!==i){var d=h(l,a,n,c);d&&p(l,d)&&d.step--}}}(o,l,a,n)}return!1}(d))return d.result.moves.reverse()}return null},this.mergeSteps=function(e){if(!e||0===e.length)return e;var r=[];r[0]={blockIdx:e[0].blockIdx,dirIdx:e[0].dirIdx,count:1};for(var t=1;t<e.length;t++){var s=r[r.length-1],o=e[t];o.blockIdx===s.blockIdx&&o.dirIdx===s.dirIdx?s.count++:r.push({blockIdx:o.blockIdx,dirIdx:o.dirIdx,count:1})}return r}}if("undefined"!=typeof define&&null!==define&&define.amd)e.r,void 0!==d&&e.v(d);else null!==r&&r.exports===t?r.exports=d:"undefined"!=typeof self&&"function"==typeof self.postMessage&&"function"==typeof self.importScripts?self.Klotski=d:"undefined"!=typeof window&&null!==window&&(window.Klotski=d)}()},92743,e=>{"use strict";e.s(["default",()=>f],92743);var r=e.i(52335),t=e.i(28842),s=e.i(33399),o=e.i(73005),l=e.i(69754);function a(){try{return e.r(34975),!0}catch(e){return!1}}function n(){let{blocks:s,moveBlock:o}=(0,l.useGameStore)(),[n,i]=(0,t.useState)(!1),[c,d]=(0,t.useState)(null),[u,h]=(0,t.useState)(!1),[p,f]=(0,t.useState)(!1),[m,x]=(0,t.useState)(0),[g,b]=(0,t.useState)(!1),v=(0,t.useRef)(!1),y=(0,t.useRef)(!1),k=(0,t.useRef)(0);(0,t.useEffect)(()=>{b(a())},[]);let w=async()=>{i(!0),d(null),x(0);try{let r=function(r){if(!a())return console.error("❌ Klotski library is not available"),{success:!1,moves:[],totalSteps:0,statesExplored:0,timeElapsed:0};try{let t=function(r){let t=Date.now();try{let s=e.r(34975),o={blocks:r.map(e=>({shape:e.shape,position:e.position})),boardSize:[5,4],escapePoint:[3,1]};console.log("Klotski 游戏配置:",o);let l=new s().solve(o);if(console.log("Klotski 求解结果:",l),console.log("求解步骤数量:",(null==l?void 0:l.length)||0),!(l&&Array.isArray(l))||!(l.length>0))return console.log("Klotski 库未找到解法，将回退到自实现算法"),{success:!1,moves:[],totalSteps:0,timeElapsed:Date.now()-t};{let e=function(e,r){let t=[],s=r.map(e=>({...e})),o={0:"down",1:"right",2:"up",3:"left"};for(let r of e){let e;if(!r||void 0===r.blockIdx||void 0===r.dirIdx)continue;let l=s[r.blockIdx];if(!l)continue;let a=o[r.dirIdx]||"down",[n,i]=l.position;switch(a){case"down":e=[n+1,i];break;case"up":e=[n-1,i];break;case"right":e=[n,i+1];break;case"left":e=[n,i-1];break;default:continue}let[c,d]=e;if(c<0||c>=5||d<0||d>=4)continue;let[u,h]=l.shape;if(c+u>5||d+h>4||c<0||d<0){console.log("跳过无效移动: ".concat(l.id," 到 [").concat(c,", ").concat(d,"] (超出边界)"));continue}let p=!1;for(let e of s){if(e.id===l.id)continue;let[r,t]=e.position,[s,o]=e.shape;if(!(c>=r+s||c+u<=r||d>=t+o||d+h<=t)){p=!0;break}}if(p){console.log("跳过冲突移动: ".concat(l.id," 到 [").concat(c,", ").concat(d,"] (与其他方块冲突)"));continue}let f={blockId:l.id,from:[n,i],to:e,direction:a};t.push(f),console.log("有效移动: ".concat(l.id," ").concat(a," 从 [").concat(n,", ").concat(i,"] 到 [").concat(c,", ").concat(d,"]")),l.position=e}return t}(l,r);return console.log("转换后的移动数量:",e.length),console.log("前3步移动:",e.slice(0,3)),{success:!0,moves:e,totalSteps:e.length,timeElapsed:Date.now()-t}}}catch(e){return console.error("Klotski 求解失败:",e),{success:!1,moves:[],totalSteps:0,timeElapsed:Date.now()-t}}}(r);if(t.success)return console.log("✅ Successfully solved using klotski library"),{success:!0,moves:t.moves,totalSteps:t.totalSteps,statesExplored:0,timeElapsed:t.timeElapsed};return console.log("⚠️ Klotski library found no solution"),{success:!1,moves:[],totalSteps:0,statesExplored:0,timeElapsed:t.timeElapsed}}catch(e){return console.error("❌ Klotski library failed:",e),{success:!1,moves:[],totalSteps:0,statesExplored:0,timeElapsed:0}}}(s);d(r)}catch(e){console.error("Solving failed:",e),alert("Solving failed, please try again later")}finally{i(!1)}},j=async()=>{if(!c||!c.success)return;if(p){f(!1),v.current=!1;return}h(!0),f(!1),v.current=!1,y.current=!1,k.current=0,x(0);let e=async r=>{if(y.current||r>=c.moves.length||v.current&&(await new Promise(e=>{let r=setInterval(()=>{(!v.current||y.current)&&(clearInterval(r),e())},100)}),y.current)){h(!1),f(!1),v.current=!1,y.current=!1;return}let t=c.moves[r];if(x(r+1),k.current=r+1,await new Promise(e=>setTimeout(e,400)),y.current){h(!1),f(!1),v.current=!1,y.current=!1;return}o(t.blockId,t.to),e(r+1)};e(0)};return(0,r.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm rounded-xl shadow-lg p-6 space-y-4",children:[!g&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[(0,r.jsx)("span",{className:"text-lg",children:"❌"}),(0,r.jsx)("span",{className:"font-medium",children:"Klotski Library Not Available"})]})}),(0,r.jsx)("button",{onClick:w,disabled:n||u,className:"w-full py-3 px-4 rounded-lg font-semibold text-white transition-all ".concat(n||u?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 shadow-md hover:shadow-lg"),children:n?(0,r.jsxs)("span",{className:"flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"AI is thinking..."]}):"🚀 Start Solving"}),c&&(0,r.jsx)("div",{className:"p-4 rounded-lg ".concat(c.success?"bg-green-50 border-2 border-green-200":"bg-red-50 border-2 border-red-200"),children:c.success?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-green-700 font-semibold",children:[(0,r.jsx)("span",{className:"text-2xl",children:"✅"}),(0,r.jsx)("span",{children:"Solution Found!"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{className:"bg-white/50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-gray-600",children:"Total Steps"}),(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:c.totalSteps})]}),(0,r.jsxs)("div",{className:"bg-white/50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-gray-600",children:"States Explored"}),(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:c.statesExplored.toLocaleString()})]}),(0,r.jsxs)("div",{className:"bg-white/50 p-3 rounded-lg col-span-2",children:[(0,r.jsx)("div",{className:"text-gray-600",children:"Solve Time"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[c.timeElapsed,"ms"]})]})]}),m>0&&(0,r.jsxs)("div",{className:"bg-white/50 p-3 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:["Progress: ",m," / ",c.totalSteps]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(m/c.totalSteps*100,"%")}})})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[u?(0,r.jsxs)(r.Fragment,{children:[p?(0,r.jsx)("button",{onClick:j,className:"flex-1 py-2 px-4 rounded-lg font-semibold text-white transition-all bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600",children:"▶️ Resume"}):(0,r.jsx)("button",{onClick:()=>{f(!0),v.current=!0},className:"flex-1 py-2 px-4 rounded-lg font-semibold text-white transition-all bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600",children:"⏸️ Pause"}),(0,r.jsx)("button",{onClick:()=>{h(!1),f(!1),v.current=!1,y.current=!0},className:"py-2 px-4 rounded-lg font-semibold text-white transition-all bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600",children:"⏹️ Stop"})]}):(0,r.jsx)("button",{onClick:j,className:"flex-1 py-2 px-4 rounded-lg font-semibold text-white transition-all bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600",children:"▶️ Auto Demo"}),(0,r.jsx)("button",{onClick:()=>{if(!c||!c.success||m>=c.moves.length)return;let e=c.moves[m];o(e.blockId,e.to),x(m+1),u&&!p&&(async()=>{if(m+1>=c.moves.length){h(!1),f(!1),v.current=!1,y.current=!1;return}for(let e=m+1;e<c.moves.length&&!y.current&&!v.current;e++){let r=c.moves[e];if(x(e+1),await new Promise(e=>setTimeout(e,400)),y.current){h(!1),f(!1),v.current=!1,y.current=!1;return}o(r.blockId,r.to)}h(!1),f(!1),v.current=!1,y.current=!1})()},disabled:m>=c.totalSteps,className:"py-2 px-4 rounded-lg font-semibold transition-all ".concat(m>=c.totalSteps?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"),children:"⏭️ Step"})]})]}):(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-red-700 font-semibold",children:[(0,r.jsx)("span",{className:"text-2xl",children:"❌"}),(0,r.jsx)("span",{children:"No Solution Found"})]}),(0,r.jsxs)("p",{className:"text-sm text-red-600",children:["Explored ",c.statesExplored.toLocaleString()," states in ",c.timeElapsed,"ms"]}),(0,r.jsx)("p",{className:"text-xs text-gray-600",children:"Tip: Try increasing search depth or using a different algorithm"})]})})]})}var i=e.i(75830),c=e.i(48881),d=e.i(11090);let u="custom",h=[[2,2],[2,1],[1,2],[1,1]];function p(e){let{shape:t}=e;(0,c.getBlockName)(t);let s=(0,c.getColorByShape)(t),[o,l]=t;return(0,r.jsxs)("div",{draggable:!0,onDragStart:e=>{e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("application/json",JSON.stringify({shape:t}));let r=document.createElement("div");r.style.width="".concat(40*l,"px"),r.style.height="".concat(40*o,"px"),r.style.background=s,r.style.opacity="0.8",r.style.borderRadius="8px",r.style.border="2px solid rgba(0,0,0,0.15)",document.body.appendChild(r),e.dataTransfer.setDragImage(r,40*l/2,40*o/2),setTimeout(()=>document.body.removeChild(r),0)},className:"flex flex-col items-center gap-1 cursor-grab active:cursor-grabbing",children:[(0,r.jsx)("div",{className:"grid place-items-center rounded-lg shadow-inner border-2 border-white",style:{backgroundColor:s,width:48*l,height:48*o}}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[o,"×",l]})]})}function f(){let e=(0,s.useSearchParams)(),a=(0,s.useRouter)(),c=e.get("puzzle")||u,{loadPuzzle:f,loadCustomBoard:m,reset:x,isCustomBoard:g,selectedBlockId:b,removeBlock:v}=(0,l.useGameStore)((0,d.useShallow)(e=>({loadPuzzle:e.loadPuzzle,loadCustomBoard:e.loadCustomBoard,reset:e.reset,isCustomBoard:e.isCustomBoard,selectedBlockId:e.selectedBlockId,removeBlock:e.removeBlock}))),[y,k]=(0,t.useState)(!1),w=(0,i.getAllPuzzles)(),j=(0,t.useMemo)(()=>[{slug:u,name:"🧩 Custom Empty Board"},...w.map(e=>({slug:e.slug,name:e.name}))],[w]);return((0,t.useEffect)(()=>{k(!0)},[]),(0,t.useEffect)(()=>{y&&(c===u?m():f(c))},[y,c,f,m]),y)?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-400 via-pink-500 to-red-500 py-8 px-4",children:(0,r.jsxs)("div",{className:"container mx-auto max-w-7xl",children:[(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8 items-start",children:[(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm rounded-xl shadow-lg p-6",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("select",{value:c,onChange:e=>{let r=e.target.value;r!==c&&a.replace("/solver?puzzle=".concat(encodeURIComponent(r)),{scroll:!1})},className:"w-full px-3 py-2 border-2 border-gray-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-lg font-semibold text-gray-800 shadow-sm",children:j.map(e=>(0,r.jsx)("option",{value:e.slug,children:e.name},e.slug))})}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(o.default,{})}),g&&(0,r.jsx)("div",{className:"bg-white/90 backdrop-blur-sm rounded-xl shadow-lg p-6 space-y-4",children:(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:h.map(e=>(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-3 flex flex-col items-center gap-3 shadow-sm hover:shadow-md transition-shadow",children:(0,r.jsx)(p,{shape:e})},e.join("x")))})}),(0,r.jsx)("button",{onClick:x,className:"w-full mt-4 py-2 px-4 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-semibold transition-all",children:g?"🧼 Clear Board":"🔄 Reset Board"})]})}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(n,{})})]}),(0,r.jsx)("div",{className:"mt-8 text-center text-white/80 text-sm",children:(0,r.jsx)("p",{children:"Klotski Solver | Built with TypeScript + Next.js"})})]})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-400 via-pink-500 to-red-500",children:(0,r.jsx)("div",{className:"text-white text-2xl",children:"Loading..."})})}}]);